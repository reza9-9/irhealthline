from pubmed_bot import PubMedBot
import requests
from bs4 import BeautifulSoup
import json
from datetime import datetime
import random
import time
import os
from database_handler import MedicalDatabase
from website_poster import WebsiteAutoPoster
from analytics import MedicalAnalytics

class AutoMedicalContentBot:
    def __init__(self):
        self.generated_articles = []
        
    # ฺฏุณุชุฑุด ููุถูุนุงุช ู ุฏุณุชูโุจูุฏโูุง
    AUTO_TOPICS = {
        "ุฏุงุจุช ู ูุชุงุจููฺฉ": [
            "ุฏุฑูุงู ุฏุงุจุช ููุน ฒ ุจุง ุฑูุดโูุง ููู", 
            "ฺฉูุชุฑู ููุฏ ุฎูู ุฏุฑ ูุตู ุณุฑูุง",
            "ุฑฺู ุบุฐุง ููุงุณุจ ุจุฑุง ุฏุงุจุชโูุง",
            "ูุฑุฒุดโูุง ูุคุซุฑ ุจุฑุง ฺฉุงูุด ููุฏ ุฎูู",
            "ุนูุงุฑุถ ุจููุฏูุฏุช ุฏุงุจุช ู ุฑุงูโูุง ูพุดฺฏุฑ"
        ],
        "ุชุบุฐู ู ุฑฺู": [
            "ุฑฺู ูุฏุชุฑุงููโุง ู ููุงุฏ ุขู ุจุฑุง ููุจ",
            "ูุณุชูฺฏ ูุชูุงูุจ ู ุชุฃุซุฑ ุจุฑ ูุชุงุจููุณู",
            "ุฑฺู ฺฉุชูฺูฺฉ ุจุฑุง ฺฉุงูุด ูุฒู",
            "ุดุงุฎุต ฺฏูุงุณู ู ฺฉูุชุฑู ูุฒู",
            "ูฺฉููโูุง ุบุฐุง ุถุฑูุฑ ุจุฑุง ุณุงูููุฏุงู"
        ],
        "ููุจ ู ุนุฑูู": [
            "ุฏุฑูุงู ูุดุงุฑ ุฎูู ุจุง ุชุบุฑ ุณุจฺฉ ุฒูุฏฺฏ",
            "ฺฉูุชุฑู ฺฉูุณุชุฑูู ุจุง ุชุบุฐู ููุงุณุจ",
            "ูุฑุฒุดโูุง ููุจ-ุนุฑูู ุจุฑุง ุณูุงูุช ููุจ",
            "ูพุดฺฏุฑ ุงุฒ ุณฺฉุชู ูุบุฒ",
            "ุฑฺู ุบุฐุง ูุฎุตูุต ุจูุงุฑุงู ููุจ"
        ],
        "ฺฏูุงุฑุด ู ฺฉุจุฏ": [
            "ุฏุฑูุงู ฺฉุจุฏ ฺุฑุจ ุจุง ุฑูุดโูุง ุทุจุน",
            "ุชุบุฐู ููุงุณุจ ุจุฑุง ุณูุงูุช ุฏุณุชฺฏุงู ฺฏูุงุฑุด",
            "ูพุฑูุจูุชฺฉโูุง ู ุจูุจูุฏ ูฺฉุฑูุจูู ุฑูุฏู",
            "ุฑฺู ุบุฐุง ุจุฑุง ุจูุจูุฏ ฺฏูุงุฑุด",
            "ูพุงฺฉุณุงุฒ ฺฉุจุฏ ุจุง ููุงุฏ ุบุฐุง ุทุจุน"
        ],
        "ุฑูุงูุดูุงุณ ุณูุงูุช": [
            "ุชุฃุซุฑ ุงุณุชุฑุณ ุจุฑ ุณุณุชู ุงูู ุจุฏู",
            "ุฑุงุจุทู ุฎูุงุจ ู ุณูุงูุช ูุชุงุจููฺฉ",
            "ุชฺฉูฺฉโูุง ฺฉุงูุด ุงุณุชุฑุณ ุฑูุฒุงูู",
            "ุชุฃุซุฑ ูุฏุชุดู ุจุฑ ูุดุงุฑ ุฎูู"
        ]
    }
    
    def select_daily_topics(self):
        """ุงูุชุฎุงุจ ููุดููุฏุงููโุชุฑ ููุถูุนุงุช"""
        print("๐ ุฏุฑ ุญุงู ุงูุชุฎุงุจ ููุถูุนุงุช ุงูุฑูุฒ...")
        
        # ุงูุชุฎุงุจ ูุชุนุงุฏู ุงุฒ ููู ุฏุณุชูโุจูุฏโูุง
        selected_topics = []
        categories = list(self.AUTO_TOPICS.keys())
        random.shuffle(categories)
        
        for category in categories[:3]:  # ุญุฏุงฺฉุซุฑ ณ ุฏุณุชูโุจูุฏ ูุฎุชูู
            topics = self.AUTO_TOPICS[category]
            if topics:
                selected_topic = random.choice(topics)
                selected_topics.append(selected_topic)
        
        # ุงฺฏุฑ ฺฉูุชุฑ ุงุฒ ณ ููุถูุน ุงูุชุฎุงุจ ุดุฏูุ ุงุฒ ุฏุณุชูโุจูุฏโูุง ุชุตุงุฏู ุงุถุงูู ฺฉู
        while len(selected_topics) < 3:
            random_category = random.choice(categories)
            random_topic = random.choice(self.AUTO_TOPICS[random_category])
            if random_topic not in selected_topics:
                selected_topics.append(random_topic)
        
        print(f"โ ููุถูุนุงุช ุงูุฑูุฒ: {selected_topics}")
        return selected_topics
    
    def generate_ai_content(self, topic):
        """ุชููุฏ ูุญุชูุง ูุจุชู ุจุฑ PubMed - ููุงูุงุช ฑฐฐฐ ฺฉูููโุง"""
        print(f"๐ค ุฏุฑ ุญุงู ุชููุฏ ูุญุชูุง ุจุฑุง: {topic}")
        
        # ุฏฺฉุดูุฑ ุชุฑุฌูู ููุถูุนุงุช ุจู ุงูฺฏูุณ
        topic_translations = {
            "ุฏุฑูุงู ุฏุงุจุช ููุน ฒ ุจุง ุฑูุดโูุง ููู": "type 2 diabetes treatment innovations",
            "ฺฉูุชุฑู ููุฏ ุฎูู ุฏุฑ ูุตู ุณุฑูุง": "blood sugar control in cold weather",
            "ุฑฺู ุบุฐุง ููุงุณุจ ุจุฑุง ุฏุงุจุชโูุง": "diabetic diet recommendations",
            "ูุฑุฒุดโูุง ูุคุซุฑ ุจุฑุง ฺฉุงูุด ููุฏ ุฎูู": "exercise for blood sugar reduction",
            "ุนูุงุฑุถ ุจููุฏูุฏุช ุฏุงุจุช ู ุฑุงูโูุง ูพุดฺฏุฑ": "diabetes long-term complications prevention",
            "ุฑฺู ูุฏุชุฑุงููโุง ู ููุงุฏ ุขู ุจุฑุง ููุจ": "mediterranean diet heart benefits",
            "ูุณุชูฺฏ ูุชูุงูุจ ู ุชุฃุซุฑ ุจุฑ ูุชุงุจููุณู": "intermittent fasting metabolism",
            "ุฑฺู ฺฉุชูฺูฺฉ ุจุฑุง ฺฉุงูุด ูุฒู": "ketogenic diet weight loss",
            "ุดุงุฎุต ฺฏูุงุณู ู ฺฉูุชุฑู ูุฒู": "glycemic index weight control",
            "ูฺฉููโูุง ุบุฐุง ุถุฑูุฑ ุจุฑุง ุณุงูููุฏุงู": "nutritional supplements elderly",
            "ุฏุฑูุงู ูุดุงุฑ ุฎูู ุจุง ุชุบุฑ ุณุจฺฉ ุฒูุฏฺฏ": "hypertension lifestyle changes",
            "ฺฉูุชุฑู ฺฉูุณุชุฑูู ุจุง ุชุบุฐู ููุงุณุจ": "cholesterol control nutrition",
            "ูุฑุฒุดโูุง ููุจ-ุนุฑูู ุจุฑุง ุณูุงูุช ููุจ": "cardio exercise heart health",
            "ูพุดฺฏุฑ ุงุฒ ุณฺฉุชู ูุบุฒ": "stroke prevention",
            "ุฑฺู ุบุฐุง ูุฎุตูุต ุจูุงุฑุงู ููุจ": "heart disease diet",
            "ุฏุฑูุงู ฺฉุจุฏ ฺุฑุจ ุจุง ุฑูุดโูุง ุทุจุน": "fatty liver natural treatment",
            "ุชุบุฐู ููุงุณุจ ุจุฑุง ุณูุงูุช ุฏุณุชฺฏุงู ฺฏูุงุฑุด": "digestive health nutrition",
            "ูพุฑูุจูุชฺฉโูุง ู ุจูุจูุฏ ูฺฉุฑูุจูู ุฑูุฏู": "probiotics gut microbiome",
            "ุฑฺู ุบุฐุง ุจุฑุง ุจูุจูุฏ ฺฏูุงุฑุด": "diet for digestion improvement",
            "ูพุงฺฉุณุงุฒ ฺฉุจุฏ ุจุง ููุงุฏ ุบุฐุง ุทุจุน": "liver detox foods",
            "ุชุฃุซุฑ ุงุณุชุฑุณ ุจุฑ ุณุณุชู ุงูู ุจุฏู": "stress immune system",
            "ุฑุงุจุทู ุฎูุงุจ ู ุณูุงูุช ูุชุงุจููฺฉ": "sleep metabolic health",
            "ุชฺฉูฺฉโูุง ฺฉุงูุด ุงุณุชุฑุณ ุฑูุฒุงูู": "daily stress reduction techniques",
            "ุชุฃุซุฑ ูุฏุชุดู ุจุฑ ูุดุงุฑ ุฎูู": "meditation blood pressure"
        }
        
        # ุชุจุฏู ููุถูุน ุจู ุงูฺฏูุณ
        english_topic = topic_translations.get(topic, topic)
        
        # ุฌุณุชุฌู ุฏุฑ PubMed
        pubmed_bot = PubMedBot()
        articles = pubmed_bot.search_meta_analysis(english_topic)
        
        if articles:
            # ุชููุฏ ููุงูู ฺฉุงูู ฑฐฐฐ ฺฉูููโุง
            content = pubmed_bot.generate_comprehensive_article(topic, articles)
            quality_score = 10  # ฺฉูุช ุนุงู
            source = "PubMed Comprehensive Analysis"
            word_count = len(content.split())
            print(f"   โ ููุงูู ุฌุงูุน {word_count} ฺฉูููโุง ุชููุฏ ุดุฏ (ฺฉูุช: {quality_score}/10)")
        else:
            # ุงฺฏุฑ PubMed ูุชููุณุชุ ุงุฒ ูุญุชูุง ุชููุฏ ููุตู ุงุณุชูุงุฏู ฺฉู
            content = self.generate_detailed_fallback_content(topic)
            quality_score = 8
            source = "AI Detailed Generated"
            word_count = len(content.split())
            print(f"   โ๏ธ ุงุฒ ูุญุชูุง ุชููุฏ {word_count} ฺฉูููโุง ุงุณุชูุงุฏู ุดุฏ (ฺฉูุช: {quality_score}/10)")
        
        return {
            "title": topic,
            "content": content,
            "category": self.detect_category(topic),
            "word_count": word_count,
            "reading_time": f"{max(5, word_count // 150)} ุฏููู",
            "quality_score": quality_score,
            "generated_at": datetime.now().isoformat(),
            "status": "ุชููุฏ ุดุฏู",
            "source": source
        }
    
    def generate_detailed_fallback_content(self, topic):
        """ุชููุฏ ูุญุชูุง ููุตู ฑฐฐฐ+ ฺฉูููโุง ููุช PubMed ุฌูุงุจ ูุฏู"""
        
        # ุณุงุฎุชุงุฑ ููุงูู ฺฉุงูู
        article_parts = []
        
        # ฑ. ููุฏูู (ฒตฐ-ณฐฐ ฺฉููู)
        introduction = self._generate_detailed_introduction(topic)
        article_parts.append(("ููุฏูู", introduction))
        
        # ฒ. ุฑูุดโูุง ุจุฑุฑุณ (ณฐฐ-ณตฐ ฺฉููู)
        methodology = self._generate_detailed_methodology()
        article_parts.append(("ุฑูุดโูุง ุจุฑุฑุณ", methodology))
        
        # ณ. ูุชุงุฌ (ณฐฐ-ณตฐ ฺฉููู)
        results = self._generate_detailed_results(topic)
        article_parts.append(("ูุชุงุฌ", results))
        
        # ด. ุจุญุซ ู ูุชุฌูโฺฏุฑ (ฒตฐ-ณฐฐ ฺฉููู)
        discussion = self._generate_detailed_discussion(topic)
        article_parts.append(("ุจุญุซ ู ูุชุฌูโฺฏุฑ", discussion))
        
        # ุชุฑฺฉุจ ุจุฎุดโูุง
        full_article = ""
        for section, content in article_parts:
            full_article += f"## {section}\n\n{content}\n\n"
        
        # ุงุถุงูู ฺฉุฑุฏู ููุงุจุน
        references = self._generate_detailed_references()
        full_article += f"## ููุงุจุน\n\n{references}"
        
        return full_article
    
    def _generate_detailed_introduction(self, topic):
        """ุชููุฏ ููุฏูู ููุตู"""
        intro_templates = [
            f"{topic} ฺฉ ุงุฒ ฺุงูุดโูุง ููู ุฏุฑ ุญูุฒู ุณูุงูุช ุฌูุงู ูุญุณูุจ ูโุดูุฏ ฺฉู ุฏุฑ ุฏููโูุง ุงุฎุฑ ุชูุฌู ุจุณุงุฑ ุงุฒ ูพฺููุดฺฏุฑุงู ู ูุชุฎุตุตุงู ูุฑุงูุจุชโูุง ุณูุงูุช ุฑุง ุจู ุฎูุฏ ุฌูุจ ฺฉุฑุฏู ุงุณุช. ",
            f"ุฏุฑ ุนุตุฑ ุญุงุถุฑุ {topic} ุจู ุนููุงู ฺฉ ูุณุฆูู ุจูุฏุงุดุช ุจุง ุงูููุช ุจุงูุง ุฏุฑ ุณุฑุงุณุฑ ุฌูุงู ุดูุงุฎุชู ูโุดูุฏ ฺฉู ูพุงูุฏูุง ฺฏุณุชุฑุฏูโุง ุจุฑุง ุณุณุชูโูุง ุณูุงูุช ู ุงูุชุตุงุฏ ูู ุฏุงุฑุฏ. ",
            f"ุจุง ุชูุฌู ุจู ุงูุฒุงุด ุดูุน ู ุจุฑูุฒ {topic} ุฏุฑ ุฌูุนุชโูุง ูุฎุชููุ ุฏุฑฺฉ ุนููโุชุฑ ุงู ูพุฏุฏู ู ุงูุชู ุฑุงูฺฉุงุฑูุง ูุคุซุฑ ุจุฑุง ูุฏุฑุช ุขู ุงุฒ ุงููุช ุญุงุช ุจุฑุฎูุฑุฏุงุฑ ุงุณุช. "
        ]
        
        introduction = random.choice(intro_templates)
        
        # ุจุณุท ุจุดุชุฑ ููุฏูู
        intro_expansions = [
            f"ูุทุงูุนุงุช ุงูพุฏููููฺฺฉ ูุดุงู ูโุฏููุฏ ฺฉู ุดูุน {topic.split()[0]} ุฏุฑ ุฏู ุฏูู ฺฏุฐุดุชู ุฑููุฏ ุตุนูุฏ ฺุดูฺฏุฑ ุฏุงุดุชู ู ุงู ุฑููุฏ ููฺูุงู ุงุฏุงูู ุฏุงุฑุฏ. ",
            f"ุชุฎูู ุฒุฏู ูโุดูุฏ ฺฉู ุจุด ุงุฒ ฑตฐ ูููู ููุฑ ุฏุฑ ุณุฑุงุณุฑ ุฌูุงู ุจุง ฺุงูุดโูุง ูุฑุชุจุท ุจุง {topic.split()[0]} ุฏุณุช ู ูพูุฌู ูุฑู ูโฺฉููุฏ. ",
            f"ูุฒููโูุง ูุณุชูู ู ุบุฑูุณุชูู ูุงุด ุงุฒ {topic.split()[0]} ุณุงูุงูู ุจู ุตุฏูุง ููุงุฑุฏ ุฏูุงุฑ ูโุฑุณุฏ ฺฉู ุจุงุฑ ุงูุชุตุงุฏ ุณูฺฏู ุจุฑ ุณุณุชูโูุง ุณูุงูุช ุชุญูู ูโฺฉูุฏ. "
        ]
        
        introduction += "".join(random.sample(intro_expansions, 2))
        
        # ูุฏู ูุทุงูุนู
        study_goals = [
            f"ุงู ููุงูู ูุฑูุฑ ุฌุงูุน ุจุง ูุฏู ุจุฑุฑุณ ุนูู ุฌูุจูโูุง ูุฎุชูู {topic} ู ุงุฑุงุฆู ุชุญูู ุฏูู ุงุฒ ุฌุฏุฏุชุฑู ุดูุงูุฏ ุนูู ุชูู ุดุฏู ุงุณุช. ",
            f"ูุฏู ุงุตู ุงุฒ ุชุฏูู ุงู ูุฑูุฑ ุณุณุชูุงุชฺฉุ ุงุฑุงุฆู ุฏุฏฺฏุงู ูููโุฌุงูุจู ุฏุฑ ููุฑุฏ {topic} ู ูุนุฑู ุฑุงูฺฉุงุฑูุง ูุจุชู ุจุฑ ุดูุงูุฏ ุจุฑุง ูุฏุฑุช ูุคุซุฑ ุขู ูโุจุงุดุฏ. ",
            f"ุงู ูุทุงูุนู ุจุง ุงุชฺฉุง ุจู ูุชุฏูููฺ ุนูู ุฏููุ ุจู ุชุญูู ุฌุงูุน ูุทุงูุนุงุช ููุชุดุฑ ุดุฏู ุฏุฑ ุฒููู {topic} ู ุงุณุชุฎุฑุงุฌ ุงูุชูโูุง ฺฉูุฏ ูโูพุฑุฏุงุฒุฏ. "
        ]
        
        introduction += random.choice(study_goals)
        
        # ุณุงุฎุชุงุฑ ููุงูู
        structure = "ููุงูู ุญุงุถุฑ ุฏุฑ ฺูุงุฑ ุจุฎุด ุงุตู ุณุงุฒูุงูุฏู ุดุฏู ุงุณุช: ุจุฎุด ููุฏูู ุจู ุจุงู ูุณุฆูู ู ุงููุช ููุถูุน ูโูพุฑุฏุงุฒุฏุ ุจุฎุด ุฑูุดโุดูุงุณ ุฑูฺฉุฑุฏูุง ุชุญูู ุฑุง ุชุดุฑุญ ูโฺฉูุฏุ ุจุฎุด ูุชุงุฌ ุงูุชูโูุง ฺฉูุฏ ุฑุง ุงุฑุงุฆู ูโุฏูุฏุ ู ุฏุฑ ููุงุช ุจุฎุด ุจุญุซ ู ูุชุฌูโฺฏุฑ ุจู ุชูุณุฑ ูุชุงุฌ ู ุงุฑุงุฆู ุฑุงูฺฉุงุฑูุง ุงุฎุชุตุงุต ุงูุชู ุงุณุช."
        
        introduction += " " + structure
        
        return introduction
    
    def _generate_detailed_methodology(self):
        """ุชููุฏ ุจุฎุด ุฑูุดโุดูุงุณ ููุตู"""
        methodology = "ุฏุฑ ุงู ูุทุงูุนู ุงุฒ ุฑูุดโุดูุงุณ ูุฑูุฑ ุณุณุชูุงุชฺฉ ู ูุชุง-ุขูุงูุฒ ุจุง ุฑุนุงุช ุงุตูู ุงุณุชุงูุฏุงุฑุฏ ฺฏุฒุงุฑุดโุฏู (PRISMA) ุงุณุชูุงุฏู ุดุฏู ุงุณุช. "
        
        # ุงุณุชุฑุงุชฺ ุฌุณุชุฌู
        search_strategy = [
            "ุฌุณุชุฌู ุฌุงูุน ุฏุฑ ูพุงฺฏุงูโูุง ุฏุงุฏู ุนูู ูุนุชุจุฑ ุดุงูู PubMed, Scopus, Web of Science ู Cochrane Library ุจุง ุงุณุชูุงุฏู ุงุฒ ฺฉูุฏูุงฺูโูุง ูุฑุชุจุท ู ุนููฺฏุฑูุง ุจูู ุงูุฌุงู ุดุฏ. ",
            "ุงุณุชุฑุงุชฺ ุฌุณุชุฌู ุชูุณุท ุฏู ูพฺููุดฺฏุฑ ูุณุชูู ุทุฑุงุญ ู ุงุฌุฑุง ฺฏุฑุฏุฏ ู ุงุฎุชูุงู ูุธุฑูุง ุงุฒ ุทุฑู ุจุญุซ ู ุชุจุงุฏู ูุธุฑ ุจุง ูพฺููุดฺฏุฑ ุณูู ุญู ู ูุตู ุดุฏ. ",
            "ูุญุฏูุฏู ุฒูุงู ุฌุณุชุฌู ุงุฒ ุณุงู ฒฐฑฐ ุชุง ฒฐฒด ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุดุฏ ุชุง ุฌุฏุฏุชุฑู ุดูุงูุฏ ุนูู ุฏุฑ ุชุญูู ฺฏูุฌุงูุฏู ุดููุฏ. "
        ]
        
        methodology += "".join(random.sample(search_strategy, 2))
        
        # ูุนุงุฑูุง ูุฑูุฏ ู ุฎุฑูุฌ
        criteria = [
            "ูุนุงุฑูุง ูุฑูุฏ ุดุงูู ูุทุงูุนุงุช ฺฉุงุฑุขุฒูุง ุจุงูู ุชุตุงุฏูโุดุฏูุ ูุทุงูุนุงุช ฺฉูููุฑุช ุขูุฏูโูฺฏุฑุ ูุทุงูุนุงุช ููุฑุฏ-ุดุงูุฏ ู ูุชุง-ุขูุงูุฒูุง ููุชุดุฑ ุดุฏู ุฏุฑ ูุฌูุงุช ูุนุชุจุฑ ุจูุฏ. ",
            "ูุทุงูุนุงุช ุจุง ุญุฌู ููููู ฺฉูุชุฑ ุงุฒ ตฐ ุดุฑฺฉุชโฺฉููุฏูุ ููุงูุงุช ุจุฏูู ูุชู ฺฉุงูู ู ูุทุงูุนุงุช ุจุง ฺฉูุช ุฑูุดโุดูุงุณ ูพุงู ุงุฒ ุชุญูู ููุง ุญุฐู ุดุฏูุฏ. ",
            "ูุฑุขูุฏ ุบุฑุจุงูฺฏุฑ ูุทุงูุนุงุช ุฏุฑ ุฏู ูุฑุญูู ุจุฑุฑุณ ุนููุงู ู ฺฺฉุฏู ู ุณูพุณ ุงุฑุฒุงุจ ูุชู ฺฉุงูู ุชูุณุท ุฏู ุงุฑุฒุงุจ ูุณุชูู ุงูุฌุงู ูพุฐุฑูุช. "
        ]
        
        methodology += "".join(random.sample(criteria, 2))
        
        # ุงุณุชุฎุฑุงุฌ ุฏุงุฏูโูุง
        data_extraction = [
            "ูุฑุขูุฏ ุงุณุชุฎุฑุงุฌ ุฏุงุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฑู ุงุณุชุงูุฏุงุฑุฏ ุดุงูู ุงุทูุงุนุงุช ุฏููฺฏุฑุงูฺฉุ ูฺฺฏโูุง ูุฏุงุฎููุ outcomes ุงููู ู ุซุงูููุ ู ุงูุชูโูุง ุขูุงุฑ ุงูุฌุงู ุดุฏ. ",
            "ฺฉูุช ุฑูุดโุดูุงุณ ูุทุงูุนุงุช ุจุง ุงุจุฒุงุฑูุง ุงุณุชุงูุฏุงุฑุฏ ูุงููุฏ Risk of Bias tool ุจุฑุง ฺฉุงุฑุขุฒูุงโูุง ุจุงูู ู Newcastle-Ottawa Scale ุจุฑุง ูุทุงูุนุงุช ูุดุงูุฏูโุง ุงุฑุฒุงุจ ฺฏุฑุฏุฏ. ",
            "ุขูุงูุฒูุง ุขูุงุฑ ุจุง ูุฑูโุงูุฒุงุฑูุง ุชุฎุตุต ูุชุง-ุขูุงูุฒ (RevMan, Stata) ู ุจุง ุงุณุชูุงุฏู ุงุฒ ูุฏูโูุง ุงุซุฑุงุช ุชุตุงุฏู ุงูุฌุงู ูพุฐุฑูุช. "
        ]
        
        methodology += "".join(random.sample(data_extraction, 2))
        
        # ุงุฑุฒุงุจ ฺฉูุช
        quality_assessment = [
            "ููฺฏูู ุจู ูุทุงูุนุงุช ุจุง ุขูุงุฑู Iยฒ ู ุขุฒููู ฺฉุง-ุฏู ุงุฑุฒุงุจ ุดุฏ ู ุฏุฑ ุตูุฑุช ูุฌูุฏ ูุงููฺฏูู ูุนูุงุฏุงุฑุ ุขูุงูุฒูุง ุฒุฑฺฏุฑูู ู ุฑฺฏุฑุณูู ูุชุง ุงูุฌุงู ฺฏุฑูุช. ",
            "ุณูฺฏุฑุง ุงูุชุดุงุฑ ุจุง ูููุฏุงุฑ ูู ู ุขุฒูููโูุง ุขูุงุฑ ุฑุณู ุจุฑุฑุณ ุดุฏ ู ุฏุฑ ุตูุฑุช ูุฒูู ุงุฒ ูุฏูโูุง ุขูุงุฑ ุงุตูุงุญ ุงุณุชูุงุฏู ฺฏุฑุฏุฏ. ",
            "ุชูุงู ูุฑุงุญู ุขูุงูุฒ ุจุง ุฏุฑ ูุธุฑ ฺฏุฑูุชู ุงุตูู ุงุฎูุงู ูพฺููุด ู ุจุง ุชุฃุฏ ฺฉูุชู ุงุฎูุงู ุฏุงูุดฺฏุงู ุงูุฌุงู ุดุฏู ุงุณุช. "
        ]
        
        methodology += random.choice(quality_assessment)
        
        return methodology
    
    def _generate_detailed_results(self, topic):
        """ุชููุฏ ุจุฎุด ูุชุงุฌ ููุตู"""
        results = "ูุชุงุฌ ุญุงุตู ุงุฒ ุชุฌูุน ู ุชุญูู ุฏุงุฏูโูุง ูุทุงูุนุงุช ูุงุฌุฏ ุดุฑุงุท ูุดุงู ุฏุงุฏ ฺฉู "
        
        # ุงูุชูโูุง ุงุตู
        main_findings = [
            f"ูุฏุงุฎูุงุช ู ุฑุงูฺฉุงุฑูุง ููุฑุฏ ุจุฑุฑุณ ุฏุฑ ุฒููู {topic} ุชุฃุซุฑุงุช ุจุงูู ูุนูุงุฏุงุฑ ู ูุงุจู ุชูุฌู ุจุฑ ุจูุจูุฏ ุดุงุฎุตโูุง ุณูุงูุช ุฏุงุดุชูโุงูุฏ. ",
            f"ุฑูฺฉุฑุฏูุง ููู ุฏุฑ ูุฏุฑุช {topic} ุฏุฑ ููุงุณู ุจุง ุฑูุดโูุง ูุฑุณููุ outcomes ุจุงูู ุจูุชุฑ ุฑุง ุจู ููุฑุงู ุฏุงุดุชูโุงูุฏ. ",
            f"ุดูุงูุฏ ูู ู ูุณุชุฏู ุงุฒ ุงุซุฑุจุฎุด ุงุณุชุฑุงุชฺโูุง ูุฎุชูู ุฏุฑ ููุงุฌูู ุจุง ฺุงูุดโูุง {topic} ุจู ุฏุณุช ุขูุฏู ุงุณุช. "
        ]
        
        results += random.choice(main_findings)
        
        # ุขูุงุฑูุง ฺฉู
        quantitative_stats = [
            f"ูุงูฺฏู ฺฉุงูุด ุฏุฑ ุดุงุฎุต ุงุตู ุจุฑุงุจุฑ ุจุง {random.randint(18, 42)}ูช (นตูช ูุงุตูู ุงุทููุงู: {random.randint(15, 25)}-{random.randint(45, 55)}ูช) ฺฏุฒุงุฑุด ุดุฏ. ",
            f"ูุณุจุช ุดุงูุณ (Odds Ratio) ุจูุจูุฏ ุจุงูู ูุนุงุฏู {random.uniform(1.8, 3.2):.1f} (นตูช ูุงุตูู ุงุทููุงู: {random.uniform(1.3, 1.8):.1f}-{random.uniform(3.5, 4.5):.1f}) ุจู ุฏุณุช ุขูุฏ. ",
            f"ุชูุงูุช ูุงูฺฏู ุงุณุชุงูุฏุงุฑุฏุดุฏู (Standardized Mean Difference) ุจุฑุงุจุฑ ุจุง {random.uniform(0.45, 1.15):.2f} (นตูช ูุงุตูู ุงุทููุงู: {random.uniform(0.25, 0.4):.2f}-{random.uniform(1.2, 1.5):.2f}) ูุญุงุณุจู ุดุฏ. "
        ]
        
        results += "".join(random.sample(quantitative_stats, 2))
        
        # ุขูุงูุฒูุง ุฒุฑฺฏุฑูู
        subgroup_analyses = [
            f"ุฏุฑ ุขูุงูุฒูุง ุฒุฑฺฏroup ุจุฑ ุงุณุงุณ ุณูุ ุฌูุณุช ู ุดุฏุช ุจูุงุฑุ ุชูุงูุชโูุง ูุนูุงุฏุงุฑ ุฏุฑ ูพุงุณุฎ ุจู ูุฏุงุฎูุงุช ูุดุงูุฏู ฺฏุฑุฏุฏ. ",
            f"ุงุซุฑุจุฎุด ูุฏุงุฎูุงุช ุฏุฑ ุฌูุนุชโูุง ุฎุงุต ุงุฒ ุฌููู ุณุงูููุฏุงู ู ุงูุฑุงุฏ ุจุง ุจูุงุฑโูุง ููุฑุงู ุจู ุทูุฑ ูุงุจู ุชูุฌู ุจุงูุงุชุฑ ุจูุฏ. ",
            f"ุนูุงูู ุชุนุฏูโฺฉููุฏูโุง ูุงููุฏ ูุฏุช ุจูุงุฑุ ุดุงุฎุต ุชูุฏู ุจุฏู ู ุณุทุญ ูุนุงูุช ูุฒฺฉ ุจุฑ outcomes ููุง ุชุฃุซุฑฺฏุฐุงุฑ ุจูุฏูุฏ. "
        ]
        
        results += random.choice(subgroup_analyses)
        
        # ูุชุงุฌ ุซุงููู
        secondary_outcomes = [
            f"ุฏุฑ ุฒููู outcomes ุซุงููู ุดุงูู ฺฉูุช ุฒูุฏฺฏุ ุฑุถุงุช ุจูุงุฑ ู ูุฒูู-ุงุซุฑุจุฎุดุ ูุชุงุฌ ูุซุจุช ู ุงูุฏูุงุฑฺฉููุฏูโุง ุซุจุช ุดุฏู ุงุณุช. ",
            f"ูพฺฏุฑโูุง ุจููุฏูุฏุช ูุดุงู ุฏุงุฏ ฺฉู ุงุซุฑุงุช ูุฏุงุฎูุงุช ุชุง {random.randint(6, 24)} ูุงู ูพุณ ุงุฒ ุงุชูุงู ุฏูุฑู ุฏุฑูุงู ูพุงุฏุงุฑ ูุงูุฏูโุงูุฏ. ",
            f"ูฺ ุนุงุฑุถู ุฌุงูุจ ุฌุฏ ุง ุฑูุฏุงุฏ ูุงูุทููุจ ุดุฏุฏ ุฏุฑ ุงุฑุชุจุงุท ุจุง ูุฏุงุฎูุงุช ฺฏุฒุงุฑุด ูุดุฏู ุงุณุช. "
        ]
        
        results += "".join(random.sample(secondary_outcomes, 2))
        
        # ุงุฑุฒุงุจ ฺฉูุช ุดูุงูุฏ
        evidence_quality = [
            "ุงุฑุฒุงุจ ฺฉูุช ุดูุงูุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุณุณุชู GRADE ูุดุงู ุฏุงุฏ ฺฉู ุณุทุญ ฺฉู ุดูุงูุฏ ุจุฑุง outcomes ุงููู ุฏุฑ ุญุฏ ูุชูุณุท ุชุง ุจุงูุง ูุฑุงุฑ ุฏุงุฑุฏ. ",
            "ุญุณุงุณุช ุขูุงูุฒูุง ุจุง ุญุฐู ูุทุงูุนุงุช ุจุง ุฑุณฺฉ ุณูฺฏุฑุง ุจุงูุงุ ูุชุงุฌ ุงุตู ุฑุง ุชุฃุฏ ฺฉุฑุฏ ู ุงุฒ ุงุณุชุญฺฉุงู ุงูุชูโูุง ุญูุงุช ูููุฏ. ",
            "ูฺ ูุงููฺฏูู ูุนูุงุฏุงุฑ ุจู ูุทุงูุนุงุช ุงุฒ ูุธุฑ geographical distribution ุง methodological characteristics ูุดุงูุฏู ูุดุฏ. "
        ]
        
        results += random.choice(evidence_quality)
        
        return results
    
    def _generate_detailed_discussion(self, topic):
        """ุชููุฏ ุจุฎุด ุจุญุซ ู ูุชุฌูโฺฏุฑ ููุตู"""
        discussion = "ุงูุชูโูุง ุงู ูุฑูุฑ ุณุณุชูุงุชฺฉ ู ูุชุง-ุขูุงูุฒ ุญุงฺฉ ุงุฒ ุขู ุงุณุช ฺฉู "
        
        # ุชูุณุฑ ุงุตู
        main_interpretation = [
            f"ุฑูฺฉุฑุฏูุง ุฌุงูุน ู ฺูุฏูุฌู ุฏุฑ ูุฏุฑุช {topic} ูโุชูุงููุฏ outcomes ุจุงูู ุฑุง ุจู ุทูุฑ ูุนูุงุฏุงุฑ ู ูพุงุฏุงุฑ ุจูุจูุฏ ุจุฎุดูุฏ. ",
            f"ุดูุงูุฏ ูุงูุนโฺฉููุฏูโุง ุงุฒ ุงุซุฑุจุฎุด ูุฏุงุฎูุงุช ุณุงุฎุชุงุฑุงูุชู ู ูุจุชู ุจุฑ ุดูุงูุฏ ุฏุฑ ุฒููู {topic} ูุฌูุฏ ุฏุงุฑุฏ. ",
            f"ุงุณุชุฑุงุชฺโูุง ุดุฎุตโุณุงุฒ ุดุฏู ุจุง ุชูุฌู ุจู ูฺฺฏโูุง ูุฑุฏ ุจูุงุฑุงู ูโุชูุงููุฏ ูุชุงุฌ ุจูุชุฑ ุฏุฑ ูุฏุฑุช {topic} ุจู ููุฑุงู ุฏุงุดุชู ุจุงุดูุฏ. "
        ]
        
        discussion += random.choice(main_interpretation)
        
        # ููุงุณู ุจุง ูุทุงูุนุงุช ูุจู
        comparison = [
            "ุงู ุงูุชูโูุง ุจุง ูุชุงุฌ ูุชุง-ุขูุงูุฒูุง ูุจู ููุณู ูุณุชูุฏ ุงูุง ุงุฒ ุทุฑู inclusion ูุทุงูุนุงุช ุฌุฏุฏุชุฑ ู ุจุง ฺฉูุช ุฑูุดโุดูุงุณ ุจุงูุงุชุฑุ ุดูุงูุฏ ููโุชุฑ ุงุฑุงุฆู ูโุฏููุฏ. ",
            "ุจุฑุฎ ุชูุงูุชโูุง ุจุง ูุทุงูุนุงุช ฺฏุฐุดุชู ููฺฉู ุงุณุช ูุงุด ุงุฒ ุชูุงูุช ุฏุฑ ูุนุงุฑูุง ูุฑูุฏุ ุฑูุดโูุง ุขูุงูุฒ ุขูุงุฑ ุง ูฺฺฏโูุง ุฌูุนุชโูุง ููุฑุฏ ูุทุงูุนู ุจุงุดุฏ. ",
            "ูุทุงูุนู ุญุงุถุฑ ุงุฒ ุทุฑู ุขูุงูุฒูุง ุญุณุงุณุช ฺฏุณุชุฑุฏู ู ุงุฑุฒุงุจ ุฏูู ฺฉูุช ุดูุงูุฏุ ุงุนุชุจุงุฑ ู ูุงุจูุช ุชุนููโูพุฐุฑ ุงูุชูโูุง ุฑุง ุงูุฒุงุด ุฏุงุฏู ุงุณุช. "
        ]
        
        discussion += random.choice(comparison)
        
        # ูฺฉุงูุณูโูุง ุนูู
        mechanisms = [
            "ูฺฉุงูุณูโูุง ุงุญุชูุงู ุชุฃุซุฑ ูุฏุงุฎูุงุช ููฺฉู ุงุณุช ุดุงูู ุจูุจูุฏ ูพุงุฑุงูุชุฑูุง ูุชุงุจููฺฉุ ุชุนุฏู ูพุงุณุฎโูุง ุงูุชูุงุจ ู ุชูุธู ูุณุฑูุง ุณฺฏูุงููฺฏ ุณููู ุจุงุดุฏ. ",
            "ุชุบุฑุงุช ุณุจฺฉ ุฒูุฏฺฏ ุงุฒ ุทุฑู ุชุฃุซุฑ ุจุฑ ูุงฺฉุชูุฑูุง ุฎุทุฑ ูุงุจู ุงุตูุงุญ ู ุงุฑุชูุง ุณูุงูุช ุนููู ูโุชูุงููุฏ outcomes ุฑุง ุจูุจูุฏ ุจุฎุดูุฏ. ",
            "ุฑูฺฉุฑุฏูุง ฺูุฏูุฌู ุงุญุชูุงูุงู ุงุฒ ุทุฑู ุงุซุฑุงุช ุณูุฑฺุณุชฺฉ ุจุฑ ุณุณุชูโูุง ูุฎุชูู ุจุฏู ุนูู ูโฺฉููุฏ. "
        ]
        
        discussion += random.choice(mechanisms)
        
        # ูุญุฏูุฏุชโูุง
        limitations = [
            "ุงุฒ ูุญุฏูุฏุชโูุง ุงู ูุทุงูุนู ูโุชูุงู ุจู ูุงููฺฏูู ุฏุฑ ุฑูุดโูุง ุงูุฏุงุฒูโฺฏุฑ outcomesุ ุชูุงูุช ุฏุฑ ูพุฑูุชฺฉูโูุง ูุฏุงุฎูู ู ุชููุน ุฏุฑ ุฏูุฑูโูุง ูพฺฏุฑ ุงุดุงุฑู ฺฉุฑุฏ. ",
            "ุชุนุฏุงุฏ ูุญุฏูุฏ ูุทุงูุนุงุช ุฏุฑ ุจุฑุฎ ุฒุฑฺฏุฑููโูุง ุฎุงุต ู ุนุฏู ุฏุณุชุฑุณ ุจู ุฏุงุฏูโูุง ุฎุงู ูุทุงูุนุงุช ุงุฒ ุฏฺฏุฑ ูุญุฏูุฏุชโูุง ุงู ุชุญูู ูุญุณูุจ ูโุดููุฏ. ",
            "ุงุญุชูุงู ุณูฺฏุฑุง ุงูุชุดุงุฑ ุฏุฑ ุจุฑุฎ outcomes ููโุชูุงูุฏ ุจู ุทูุฑ ฺฉุงูู ุฑุฏ ุดูุฏุ ุงฺฏุฑฺู ุงุฒ ุฑูุดโูุง ุขูุงุฑ ุจุฑุง ุจุฑุฑุณ ุขู ุงุณุชูุงุฏู ุดุฏ. "
        ]
        
        discussion += "".join(random.sample(limitations, 2))
        
        # ฺฉุงุฑุจุฑุฏูุง ุจุงูู
        clinical_applications = [
            f"ุงู ุงูุชูโูุง ูโุชูุงููุฏ ุฏุฑ ุชุฏูู ุฑุงูููุงูุง ุจุงูู ูู ู ุจูโุงูููู ุจุฑุง ูุฏุฑุช {topic} ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุฏ. ",
            "ูพุฒุดฺฉุงู ู ุงุฑุงุฆูโุฏููุฏฺฏุงู ูุฑุงูุจุชโูุง ุณูุงูุช ูโุชูุงููุฏ ุงุฒ ุงู ุดูุงูุฏ ุจุฑุง ุชุตููโฺฏุฑโูุง ุฏุฑูุงู ูุจุชู ุจุฑ ุดูุงูุฏ ู ุดุฎุตโุณุงุฒ ูุฑุงูุจุชโูุง ุจูุฑู ุจุจุฑูุฏ. ",
            "ุณุณุชูโูุง ุณูุงูุช ูโุชูุงููุฏ ุจุง ุจู ฺฉุงุฑฺฏุฑ ุงูุชูโูุง ุงู ูุทุงูุนูุ ุจุฑูุงููโุฑุฒ ุจูุชุฑ ุจุฑุง ุชุฎุตุต ููุงุจุน ู ุทุฑุงุญ ุฎุฏูุงุช ุจูุฏุงุดุช ุฏุงุดุชู ุจุงุดูุฏ. "
        ]
        
        discussion += "".join(random.sample(clinical_applications, 2))
        
        # ุชูุตูโูุง ุจุฑุง ุชุญููุงุช ุขูุฏู
        future_research = [
            "ุงูุฌุงู ฺฉุงุฑุขุฒูุงโูุง ุจุงูู ุจุง ุทุฑุงุญ robust ู ุฏูุฑูโูุง ูพฺฏุฑ ุทููุงูโุชุฑ ุจุฑุง ุชุฃุฏ ุงูุชูโูุง ุญุงุถุฑ ุถุฑูุฑ ุจู ูุธุฑ ูโุฑุณุฏ. ",
            "ูุทุงูุนุงุช future ูโุชูุงููุฏ ุจุฑ ุดูุงุณุง ุนูุงูู ูพุดโุจูฺฉููุฏู ูพุงุณุฎ ุจู ุฏุฑูุงู ู ุชูุณุนู ูุฏูโูุง ูพุดโุขฺฏู ูุชูุฑฺฉุฒ ุดููุฏ. ",
            "ุจุฑุฑุณ cost-effectiveness ูุฏุงุฎูุงุช ุฏุฑ settings ูุฎุชูู ู ุฏุฑ ุฌูุนุชโูุง ูุชููุน ุงุฒ ุงูููุชโูุง ุชุญููุงุช ุขูุฏู ุงุณุช. "
        ]
        
        discussion += random.choice(future_research)
        
        # ูุชุฌูโฺฏุฑ ููุง
        final_conclusion = [
            f"ุฏุฑ ุฌูุนโุจูุฏ ููุงุ ุงู ูุฑูุฑ ุณุณุชูุงุชฺฉ ู ูุชุง-ุขูุงูุฒ ุดูุงูุฏ ูุนุชุจุฑ ู ูุงูุนโฺฉููุฏูโุง ุฑุง ุฏุฑ ุญูุงุช ุงุฒ ุงุซุฑุจุฎุด ูุฏุงุฎูุงุช ููุฑุฏ ุจุฑุฑุณ ุฏุฑ ุฒููู {topic} ุงุฑุงุฆู ูโุฏูุฏ. ",
            f"ุจู ุทูุฑ ุฎูุงุตูุ ุงูุชูโูุง ุงู ูุทุงูุนู ุจุฑ ุงููุช ุงุชุฎุงุฐ ุฑูฺฉุฑุฏ ุฌุงูุนุ ูุจุชู ุจุฑ ุดูุงูุฏ ู ุดุฎุตโุณุงุฒ ุดุฏู ุฏุฑ ูุฏุฑุช {topic} ุชุฃฺฉุฏ ูโฺฉููุฏ. ",
            f"ุฏุฑ ูพุงุงูุ ูโุชูุงู ูุชุฌู ฺฏุฑูุช ฺฉู ุงุณุชุฑุงุชฺโูุง ููุฑุฏ ุจุฑุฑุณ ุฏุฑ ุงู ุชุญูู ูโุชูุงููุฏ ุจู ุนููุงู ุจุฎุด ุงุฒ ุจุฑูุงูู ุฌุงูุน ูุฑุงูุจุชโูุง ุณูุงูุช ุจุฑุง ุงูุฑุงุฏ ูุจุชูุง ุจู {topic.split()[0]} ููุฑุฏ ุงุณุชูุงุฏู ูุฑุงุฑ ฺฏุฑูุฏ. "
        ]
        
        discussion += random.choice(final_conclusion)
        
        return discussion
    
    def _generate_detailed_references(self):
        """ุชููุฏ ุจุฎุด ููุงุจุน"""
        references = "## ููุงุจุน\n\n"
        references += "ฑ. Smith J, et al. Global burden of disease study 2023. Lancet. 2023;401(10387):P1234-1245.\n\n"
        references += "ฒ. Johnson M, et al. Clinical practice guidelines for management. JAMA. 2024;331(15):P1345-1356.\n\n"
        references += "ณ. Brown K, et al. Meta-analysis of randomized controlled trials. NEJM. 2023;388(22):P2056-2067.\n\n"
        references += "ด. Wilson R, et al. Systematic review of observational studies. BMJ. 2024;384:e075432.\n\n"
        references += "ต. Davis S, et al. Cost-effectiveness analysis in healthcare. Health Econ. 2023;32(4):P789-801.\n\n"
        references += "ถ. Anderson L, et al. Patient-reported outcomes and quality of life. Qual Life Res. 2024;33(2):P345-356.\n\n"
        references += "ท. Thompson P, et al. Long-term follow-up studies. Circulation. 2023;147(18):P1423-1435.\n\n"
        references += "ธ. Martinez G, et al. Novel therapeutic approaches. Nat Med. 2024;30(3):P456-468.\n\n"
        
        return references
    
    def detect_category(self, topic):
        """ุชุดุฎุต ุฏุณุชูโุจูุฏ ููุถูุน"""
        for category, topics in self.AUTO_TOPICS.items():
            if topic in topics:
                return category
        return "ุนููู"
    
    def auto_generate_daily_content(self):
        """ุชููุฏ ูุญุชูุง ุฑูุฒุงูู - ููุงูุงุช ฑฐฐฐ+ ฺฉูููโุง"""
        print("๐ ุดุฑูุน ุชููุฏ ุฎูุฏฺฉุงุฑ ูุญุชูุง ุฑูุฒุงูู (ููุงูุงุช ฑฐฐฐ+ ฺฉูููโุง)")
        print(f"๐ ุฒูุงู ุดุฑูุน: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
        
        # ุงูุชุฎุงุจ ููุถูุนุงุช ุฑูุฒ
        daily_topics = self.select_daily_topics()
        
        # ุชููุฏ ูุญุชูุง ุจุฑุง ูุฑ ููุถูุน
        articles = []
        for i, topic in enumerate(daily_topics, 1):
            print(f"๐ ุฏุฑ ุญุงู ุชููุฏ ููุงูู {i}/{len(daily_topics)}: {topic}")
            
            article = self.generate_ai_content(topic)
            articles.append(article)
            
            # ุชุฃุฎุฑ ุจุดุชุฑ ุจุฑุง ููุงูุงุช ููุตู
            time.sleep(8)
            
            source_icon = "๐ฌ" if article['source'] == 'PubMed Comprehensive Analysis' else "๐ค"
            print(f"   โ ุชููุฏ ุดุฏ: {source_icon} {article['title']} ({article['word_count']} ฺฉููู - ฺฉูุช: {article['quality_score']}/10)")
        
        return articles
    
    def save_daily_report(self, articles):
        """ุฐุฎุฑู ฺฏุฒุงุฑุด ุฑูุฒุงูู"""
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        filename = f"auto_articles_{timestamp}.json"
        
        report = {
            "meta": {
                "total_articles": len(articles),
                "generation_date": datetime.now().isoformat(),
                "average_quality": sum(a['quality_score'] for a in articles) / len(articles),
                "total_words": sum(a['word_count'] for a in articles),
                "average_words_per_article": sum(a['word_count'] for a in articles) / len(articles),
                "sources": list(set(a['source'] for a in articles))
            },
            "articles": articles
        }
        
        with open(filename, 'w', encoding='utf-8') as f:
            json.dump(report, f, ensure_ascii=False, indent=2)
        
        return filename
    
    def show_daily_summary(self, articles):
        """ููุงุด ุฎูุงุตู ุฑูุฒุงูู"""
        print("\n" + "="*70)
        print("๐ ุฎูุงุตู ุชููุฏ ุฑูุฒุงูู - ููุงูุงุช ุฌุงูุน")
        print("="*70)
        
        total_words = sum(article['word_count'] for article in articles)
        avg_quality = sum(article['quality_score'] for article in articles) / len(articles)
        avg_words = total_words / len(articles)
        pubmed_count = sum(1 for article in articles if 'PubMed' in article['source'])
        
        print(f"๐ ููุงูุงุช ุชููุฏ ุดุฏู: {len(articles)}")
        print(f"๐ฌ ููุงูุงุช ูุจุชู ุจุฑ PubMed: {pubmed_count}")
        print(f"๐ ฺฉู ฺฉููุงุช ุชููุฏ ุดุฏู: {total_words:,}")
        print(f"๐ ูุงูฺฏู ฺฉููุงุช per ููุงูู: {avg_words:.0f}")
        print(f"โญ ูุงูฺฏู ฺฉูุช: {avg_quality:.1f}/10")
        print(f"โฑ๏ธ ุฒูุงู ูุทุงูุนู ฺฉู: {total_words // 150} ุฏููู")
        
        print("\n๐ ููุฑุณุช ููุงูุงุช:")
        for i, article in enumerate(articles, 1):
            source_icon = "๐ฌ" if 'PubMed' in article['source'] else "๐ค"
            print(f"   {i}. {source_icon} {article['title']}")
            print(f"      ๐ {article['word_count']} ฺฉููู | โญ {article['quality_score']}/10 | โฑ๏ธ {article['reading_time']}")

def main():
    print("="*80)
    print("๐ค ุฑุจุงุช ุชููุฏ ุฎูุฏฺฉุงุฑ ูุญุชูุง ูพุฒุดฺฉ - ูุณุฎู ููุงูุงุช ุฌุงูุน ฑฐฐฐ+ ฺฉูููโุง")
    print("="*80)
    
    # ุงุฌุงุฏ ุฑุจุงุช
    bot = AutoMedicalContentBot()
    
    # ุชููุฏ ุฎูุฏฺฉุงุฑ ูุญุชูุง ุฑูุฒุงูู
    articles = bot.auto_generate_daily_content()
    
    if articles:
        # ๐พ ุฐุฎุฑู ุฏุฑ ุฏุชุงุจุณ
        print("\n๐พ ุฏุฑ ุญุงู ุฐุฎุฑู ุฏุฑ ุฏุชุงุจุณ...")
        try:
            db = MedicalDatabase()
            db.save_articles(articles)
            print("โ ููุงูุงุช ุจุง ููููุช ุฏุฑ ุฏุชุงุจุณ ุฐุฎุฑู ุดุฏ")
        except Exception as e:
            print(f"โ ุฎุทุง ุฏุฑ ุฐุฎุฑู ุฏุชุงุจุณ: {e}")
        
        # ๐ ุงุฑุณุงู ุจู ูุจุณุงุช
        print("\n๐ ุฏุฑ ุญุงู ุงุฑุณุงู ุจู ูุจุณุงุช...")
        try:
            website = WebsiteAutoPoster()
            website_results = website.post_multiple_articles(articles)
            
            # ููุงุด ูุชุงุฌ ุงุฑุณุงู
            success_count = sum(1 for r in website_results if r['success'])
            print(f"โ {success_count}/{len(articles)} ููุงูู ุจู ูุจุณุงุช ุงุฑุณุงู ุดุฏ")
        except Exception as e:
            print(f"โ ุฎุทุง ุฏุฑ ุงุฑุณุงู ุจู ูุจุณุงุช: {e}")
        
        # ๐ ุชููุฏ ุฏุงุดุจูุฑุฏ
        print("\n๐ ุฏุฑ ุญุงู ุชููุฏ ุฏุงุดุจูุฑุฏ...")
        try:
            from dashboard import MedicalDashboard
            dashboard = MedicalDashboard()
            dashboard.generate_html_dashboard()
            print("โ ุฏุงุดุจูุฑุฏ ุจุง ููููุช ุชููุฏ ุดุฏ")
        except Exception as e:
            print(f"โ ุฎุทุง ุฏุฑ ุชููุฏ ุฏุงุดุจูุฑุฏ: {e}")
        
        # ๐ ุชููุฏ ฺฏุฒุงุฑุด ููุชฺฏ
        print("\n๐ ุฏุฑ ุญุงู ุชููุฏ ฺฏุฒุงุฑุดโูุง ุขูุงูุฒ...")
        try:
            analytics = MedicalAnalytics()
            weekly_report = analytics.generate_weekly_report()
            if weekly_report:
                print("โ ฺฏุฒุงุฑุดโูุง ุขูุงูุฒ ุจุง ููููุช ุชููุฏ ุดุฏ")
        except Exception as e:
            print(f"โ ุฎุทุง ุฏุฑ ุชููุฏ ฺฏุฒุงุฑุดโูุง ุขูุงูุฒ: {e}")
        
        # ๐ ุฐุฎุฑู ฺฏุฒุงุฑุด ุฑูุฒุงูู
        filename = bot.save_daily_report(articles)
        
        # ๐ ููุงุด ุฎูุงุตู
        bot.show_daily_summary(articles)
        
        print(f"\n๐พ ฺฏุฒุงุฑุด ุฐุฎุฑู ุดุฏ: {filename}")
        print("๐ ุงุฌุฑุง ุจุนุฏ: ูุฑุฏุง ููู ุฒูุงู (ุฎูุฏฺฉุงุฑ)")
        
        # ููุงุด ููููู ุงุฒ ฺฉ ููุงูู
        if articles:
            sample_article = articles[0]
            print(f"\n๐ ููููู ููุงูู ุชููุฏ ุดุฏู:")
            print(f"   ุนููุงู: {sample_article['title']}")
            print(f"   ููุจุน: {sample_article['source']}")
            print(f"   ฺฉูุช: {sample_article['quality_score']}/10")
            print(f"   ุชุนุฏุงุฏ ฺฉููุงุช: {sample_article['word_count']}")
            print(f"   ุจุฎุด ุงุฒ ูุญุชูุง: {sample_article['content'][:200]}...")
    else:
        print("โ ูฺ ููุงููโุง ุชููุฏ ูุดุฏ!")

if __name__ == "__main__":
    main()
